# OpenRouter API Configuration
# Get your API key at: https://openrouter.ai/
OPENROUTER_API_KEY=your_openrouter_api_key_here

# LLM Model (via OpenRouter)
# GLM options: z-ai/glm-4.7-flash (fast), z-ai/glm-4.7 (better), zhipu-ai/glm-4-plus
# Other options: openai/gpt-4o-mini, anthropic/claude-3-haiku, etc.
# See full list at: https://openrouter.ai/models
LLM_MODEL=z-ai/glm-4.7-flash

# Qdrant Configuration
# For local development with persistence:
QDRANT_IN_MEMORY=true
QDRANT_PERSIST_PATH=./qdrant_data

# For Qdrant Cloud:
# QDRANT_URL=https://acc5c492-7d2c-4b95-b0c5-2931ff2ecebd.eu-west-1-0.aws.cloud.qdrant.io
# QDRANT_API_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhY2Nlc3MiOiJtIn0.mpjUx25tLCPdDaEY31eqC1YcVBQijf2Tl4xru1F_56k

# Embedding Model Configuration
# Default: BAAI/bge-m3 (1024 dimensions, best for multilingual, supports hybrid search)
# Faster option: sentence-transformers/all-MiniLM-L6-v2 (384 dimensions, no sparse vectors)
EMBEDDING_MODEL_NAME=BAAI/bge-m3
EMBEDDING_DIMENSION=1024

# Retrieval + reranker tuned defaults
TRUST_PROFILE=balanced_v1
TRUST_PROFILE_VERSION=2026-02-16
RETRIEVAL_K_INITIAL=15
RERANKER_CONFIDENCE_THRESHOLD=0.45
RERANKER_MIN_DOC_SCORE=0.35
RERANKER_AMBIGUITY_MIN_GAP=0.05
RERANKER_AMBIGUITY_TOP_SCORE_CEILING=0.7
LAW_ROUTING_ENABLED=true
LAW_CATALOG_PATH=data/law_catalog.json
LAW_ROUTING_PREFILTER_K=80
LAW_ROUTING_RERANK_TOP_K=6
LAW_ROUTING_MIN_CONFIDENCE=0.30
LAW_ROUTING_UNCERTAINTY_TOP_SCORE_CEILING=0.55
LAW_ROUTING_UNCERTAINTY_MIN_GAP=0.04
LAW_ROUTING_FALLBACK_UNFILTERED=true
LAW_ROUTING_FALLBACK_MAX_LAWS=12
LAW_ROUTING_FALLBACK_MIN_LEXICAL_SUPPORT=1
LAW_ROUTING_STAGE1_MIN_DOCS=2
LAW_ROUTING_STAGE1_MIN_TOP_SCORE=0.32
LAW_COHERENCE_FILTER_ENABLED=true
LAW_COHERENCE_MIN_LAW_COUNT=2
LAW_COHERENCE_SCORE_GAP=0.15
LAW_COHERENCE_RELATIVE_GAP=0.05
LAW_COHERENCE_MAX_SCORE_WEIGHT=0.6
LAW_COHERENCE_MIN_KEEP=1
LAW_COHERENCE_DOMINANT_CONCENTRATION_THRESHOLD=0.60
LAW_RANK_FUSION_ENABLED=true
LAW_RANK_FUSION_WEIGHT_DOC_SCORE=0.55
LAW_RANK_FUSION_WEIGHT_ROUTING=0.20
LAW_RANK_FUSION_WEIGHT_AFFINITY=0.10
LAW_RANK_FUSION_WEIGHT_DOMINANCE=0.10
LAW_RANK_FUSION_WEIGHT_CONCENTRATION=0.05
LAW_UNCERTAINTY_LAW_CAP_ENABLED=true
LAW_UNCERTAINTY_LAW_CAP_MAX_LAWS=2
LAW_UNCERTAINTY_LAW_CAP_MAX_GAP=0.05
# Disable v2 editorial scroll fallback when using lovli_laws_v3 (index-time attachment)
EDITORIAL_V2_COMPAT_MODE=false

# Profile references (copy into your env as a block when needed):
# balanced_v1:
#   TRUST_PROFILE=balanced_v1
#   RETRIEVAL_K_INITIAL=20
#   RERANKER_CONFIDENCE_THRESHOLD=0.35
#   RERANKER_MIN_DOC_SCORE=0.35
#   RERANKER_AMBIGUITY_MIN_GAP=0.05
#   LAW_ROUTING_FALLBACK_UNFILTERED=true
#   LAW_COHERENCE_DOMINANT_CONCENTRATION_THRESHOLD=0.60
#
# strict_v1:
#   TRUST_PROFILE=strict_v1
#   RETRIEVAL_K_INITIAL=15
#   RERANKER_CONFIDENCE_THRESHOLD=0.45
#   RERANKER_MIN_DOC_SCORE=0.55
#   RERANKER_AMBIGUITY_MIN_GAP=0.10
#   LAW_ROUTING_FALLBACK_UNFILTERED=false
#   LAW_COHERENCE_DOMINANT_CONCENTRATION_THRESHOLD=0.70
